<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Markdown to PDF Studio</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>

/* FORCE LIGHT MODE */
:root {
    color-scheme: light only;
}

* { box-sizing: border-box; }

body {
    margin: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
    font-family: system-ui, sans-serif;
    background: #fff !important;
    color: #000 !important;
}

/* NAV */

nav {
    padding: 10px 15px;
    border-bottom: 2px solid #000;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.controls {
    display: flex;
    gap: 10px;
}

.filename-input {
    padding: 6px;
    border: 1px solid #aaa;
}

.btn-download {
    background: #000;
    color: #fff;
    border: none;
    padding: 8px 15px;
    cursor: pointer;
}

/* LAYOUT */

main {
    flex: 1;
    display: flex;
}

.pane {
    flex: 1;
    display: flex;
    flex-direction: column;
    border-right: 1px solid #ddd;
}

.pane-header {
    padding: 6px 10px;
    background: #eee;
    font-size: 11px;
    font-weight: bold;
}

textarea {
    flex: 1;
    padding: 15px;
    font-family: monospace;
    font-size: 15px;
    border: none;
    outline: none;
    resize: none;
    background: #fff;
    color: #000;
}

/* PREVIEW */

#pdf-root {
    background: #fff !important;
    color: #000 !important;
    forced-color-adjust: none;
    color-scheme: light only;
}

#pdf-root,
#pdf-root * {
    background: #fff !important;
    color: #000 !important;
    filter: none !important;
}

@media (prefers-color-scheme: dark) {
    #pdf-root,
    #pdf-root * {
        background: #fff !important;
        color: #000 !important;
    }
}

#preview {
    flex: 1;
    padding: 40px;
    overflow-y: auto;
}

#preview h1,#preview h2 {
    border-bottom: 1px solid #000;
}

#preview table {
    width: 100%;
    border-collapse: collapse;
}

#preview th,#preview td {
    border: 1px solid #000;
    padding: 6px;
}

#preview * {
    page-break-inside: avoid;
}

.no-print { }

@media(max-width:768px){
    main { flex-direction: column; }
    .pane { border-right:none; height:50%; }
}

</style>
</head>

<body>

<nav class="no-print">
    <h3>MD â†’ PDF</h3>
    <div class="controls">
        <input id="filename" class="filename-input" value="my_document">
        <button class="btn-download" onclick="exportPDF()">Save PDF</button>
    </div>
</nav>

<main>

<div class="pane no-print">
    <div class="pane-header">Editor</div>
    <textarea id="editor" oninput="renderContent()" placeholder="Type markdown..."></textarea>
</div>

<div class="pane">
    <div class="pane-header no-print">Preview</div>

    <div id="pdf-root">
        <div id="preview"></div>
    </div>

</div>

</main>

<script>

const editor = document.getElementById("editor");
const preview = document.getElementById("preview");

function renderContent() {
    preview.innerHTML = marked.parse(editor.value || "Start typing...");
}

async function exportPDF() {

    if (!editor.value.trim()) {
        alert("Editor empty");
        return;
    }

    const btn = document.querySelector(".btn-download");
    btn.innerText = "Generating...";

    const name = document.getElementById("filename").value || "document";

    /* CLONE CLEAN TREE */
    const clone = document.getElementById("pdf-root").cloneNode(true);
    clone.style.background = "#fff";
    clone.style.color = "#000";

    document.body.appendChild(clone);

    const options = {
        margin: 0.5,
        filename: name + ".pdf",
        image: { type: "jpeg", quality: 0.98 },
        html2canvas: {
            scale: 2,
            backgroundColor: "#ffffff"
        },
        jsPDF: { unit: "in", format: "letter", orientation: "portrait" }
    };

    try {
        await html2pdf().set(options).from(clone).save();
    } finally {
        clone.remove();
        btn.innerText = "Save PDF";
    }
}

renderContent();

</script>

</body>
</html>