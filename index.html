<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Markdown â†’ PDF</title>

<!-- Disable smart dark mode on iOS -->
<meta name="color-scheme" content="light only">

<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>

body{
margin:0;
height:100vh;
display:flex;
flex-direction:column;
font-family:system-ui;
}

nav{
padding:10px;
border-bottom:2px solid #000;
display:flex;
justify-content:space-between;
align-items:center;
}

main{
flex:1;
display:flex;
}

textarea{
flex:1;
border:none;
padding:15px;
font-family:monospace;
font-size:15px;
outline:none;
resize:none;
}

iframe{
flex:1;
border:none;
background:#999;
}

button{
background:black;
color:white;
border:none;
padding:8px 15px;
cursor:pointer;
}

input{
padding:6px;
}

@media(max-width:900px){
main{flex-direction:column;}
iframe{height:50vh;}
}

</style>
</head>

<body>

<nav>
<input id="filename" value="document">
<button onclick="exportPDF()">Save PDF</button>
</nav>

<main>

<textarea id="editor" oninput="render()">
# Hello

This preview is always white.

## Table

| A | B |
|---|---|
| 1 | 2 |
</textarea>

<iframe id="previewFrame"></iframe>

</main>

<script>

const iframe = document.getElementById("previewFrame");
const editor = document.getElementById("editor");

function render(){

const doc = iframe.contentDocument;

doc.open();
doc.write(`
<!DOCTYPE html>
<html>
<head>
<meta name="color-scheme" content="light only">
<style>

:root{color-scheme:light only;}

body{
margin:0;
padding:0.75in;
width:8.5in;
min-height:11in;
background:white !important;
color:black !important;
font-family:system-ui;
}

*{
background:white !important;
color:black !important;
forced-color-adjust:none;
}

h1,h2{border-bottom:1px solid black;}

table{width:100%;border-collapse:collapse;}
td,th{border:1px solid black;padding:6px;}

</style>
</head>
<body>
${marked.parse(editor.value)}
</body>
</html>
`);
doc.close();
}

async function exportPDF(){

const content = iframe.contentDocument.body;

await html2pdf().set({
margin:0,
filename:(filename.value||"document")+".pdf",
html2canvas:{
scale:2,
backgroundColor:"#ffffff"
},
jsPDF:{
unit:"in",
format:"letter",
orientation:"portrait"
}
}).from(content).save();

}

render();

</script>

</body>
</html>