<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Markdown â†’ PDF</title>

<meta name="color-scheme" content="light only">

<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>

<style>

body{
margin:0;
height:100vh;
display:flex;
flex-direction:column;
font-family:system-ui;
}

nav{
padding:10px;
border-bottom:2px solid #000;
display:flex;
justify-content:space-between;
align-items:center;
}

main{
flex:1;
display:flex;
}

/* MARKDOWN EDITOR */

textarea{
flex:1;
border-right:2px solid #000;
padding:15px;
font-family:monospace;
font-size:15px;
outline:none;
resize:none;
}

/* PREVIEW */

iframe{
flex:1;
border-left:2px solid #000;
background:#eee;
}

button{
background:black;
color:white;
border:none;
padding:8px 15px;
cursor:pointer;
}

input{
padding:6px;
}

@media(max-width:900px){
main{flex-direction:column;}
iframe{
height:50vh;
border-left:none;
border-top:2px solid #000;
}
textarea{
border-right:none;
border-bottom:2px solid #000;
}
}

</style>
</head>

<body>

<nav>
<input id="filename" value="document">
<button onclick="exportPDF()">Save PDF</button>
</nav>

<main>

<textarea id="editor" oninput="render()" placeholder="Write markdown here..."></textarea>

<iframe id="previewFrame"></iframe>

</main>

<script>

const iframe = document.getElementById("previewFrame");
const editor = document.getElementById("editor");

function render(){

const doc = iframe.contentDocument;

doc.open();
doc.write(`
<!DOCTYPE html>
<html>
<head>
<meta name="color-scheme" content="light only">

<style>

body{
margin:0;
padding:0.75in;
width:8.5in;
min-height:11in;
background:white !important;
color:black !important;
font-family:system-ui;
}

*{
background:white !important;
color:black !important;
forced-color-adjust:none;
}

h1,h2{
border-bottom:1px solid black;
}

table{
width:100%;
border-collapse:collapse;
}

td,th{
border:1px solid black;
padding:6px;
}

pre{
background:#f4f4f4 !important;
padding:10px;
}

</style>
</head>

<body>
${marked.parse(editor.value)}
</body>
</html>
`);

doc.close();
}

/* Native browser PDF */

function exportPDF(){

const printWindow = window.open('', '_blank');

printWindow.document.write(`
<!DOCTYPE html>
<html>
<head>
<title>${filename.value || "document"}</title>

<style>

@page{
size:letter;
margin:0.75in;
}

body{
font-family:system-ui;
background:white;
color:black;
}

h1,h2{
border-bottom:1px solid black;
padding-bottom:6px;
}

table{
width:100%;
border-collapse:collapse;
}

td,th{
border:1px solid black;
padding:6px;
}

pre{
background:#f4f4f4;
padding:10px;
overflow:auto;
}

code{
font-family:monospace;
}

</style>
</head>

<body>
${marked.parse(editor.value)}
</body>
</html>
`);

printWindow.document.close();
printWindow.focus();

printWindow.onload = function(){
printWindow.print();
printWindow.close();
};

}

render();

</script>

</body>
</html>
